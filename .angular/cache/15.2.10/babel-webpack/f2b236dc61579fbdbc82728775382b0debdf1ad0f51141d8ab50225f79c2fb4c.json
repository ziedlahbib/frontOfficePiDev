{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { Component } from '@angular/core';\nimport { Validators } from '@angular/forms';\nimport { Technologie } from '../../model/technologie';\nlet ForumComponent = class ForumComponent {\n  constructor(ps, formBuilder, route) {\n    this.ps = ps;\n    this.formBuilder = formBuilder;\n    this.route = route;\n    this.isReady = false;\n    this.showParagraph = true;\n    this.hide = true;\n    this.listofrep = [];\n    this.repo = [];\n    this.listofQuestion = [];\n    this.tech = Technologie;\n    this.nbrlike = [];\n    this.formGroups = [];\n    this.questionsWithResponses = [];\n    this.showResponse = [];\n    this.showParagraphs = []; // Array to store the visibility state for each comment\n  }\n\n  ngOnInit() {\n    this.currentUser = \"65d621813ece05768b528f25\";\n    this.initForm();\n    this.getallQuestion();\n    this.initFormquest();\n    this.formGroup = this.formBuilder.group({\n      contenue: ['', Validators.required]\n    });\n  }\n  addquestion() {\n    this.ps.ajoutQuestion(this.questform.value, this.currentUser).subscribe(res => {\n      console.log(res);\n      this.getallQuestion();\n    });\n  }\n  initFormquest() {\n    this.questform = this.formBuilder.group({\n      contenue: ['', Validators.required],\n      tech: [[], Validators.required]\n    });\n    this.questform.valueChanges.subscribe(data => {\n      console.log(this.questform.value);\n    });\n  }\n  getallQuestion() {\n    this.ps.getQuestions().subscribe(data => {\n      console.log(data);\n      this.listofQuestion = data;\n      this.isReady = true;\n      for (let question of data) {\n        if (question.reponses != null) {\n          for (let reponse of question.reponses) {\n            if (reponse != null) {\n              console.log(reponse);\n              const formGroup = this.initFormmodif(reponse);\n              this.formGroups.push(formGroup);\n              this.formGroups = question.reponses.map(reponse => this.initFormmodif(reponse));\n              this.initializeVisibilityState(reponse);\n            }\n          }\n        }\n        let index = this.listofQuestion.indexOf(question);\n        this.ps.getnbrvote(question.id).subscribe(res => {\n          this.nbrlike[index] = res;\n        });\n      }\n    });\n  }\n  ajouterreponse(post) {\n    console.log(this.repform.value);\n    this.ps.addreponse(post, this.currentUser, this.repform.value).subscribe(data => {\n      this.getallQuestion();\n    });\n  }\n  getcmtbypos(post) {\n    this.ps.getreponsebyquestion(post).subscribe(data => {});\n  }\n  addlike(post) {\n    this.ps.vote(post.id, this.currentUser, post).subscribe(data => {\n      console.log(data);\n      this.ps.getnbrvote(post.id).subscribe(res => {\n        console.log(this.nbrlike);\n        let index = this.listofQuestion.indexOf(post);\n        console.log(index);\n        this.nbrlike[index] = res;\n      });\n    });\n  }\n  // onTechnologySelected(technology: Technologie) {\n  //   // Handle the selected technology here\n  //   this.questform.patchValue({\n  //     tech: technology\n  //   });\n  // }\n  // onTechnologySelected(select: HTMLSelectElement) {\n  //   const selectedOptions = Array.from(select.selectedOptions).map(option => option.value);\n  //   this.questform.get('tech')?.setValue(selectedOptions);\n  // }\n  delete(cmt) {\n    this.ps.deletereponse(cmt.id).subscribe(res => {\n      this.getallQuestion();\n    });\n  }\n  modifierre(rep) {\n    this.ps.updateReponse(rep.id, this.formGroup.value).subscribe(data => {\n      this.getallQuestion();\n    });\n  }\n  initForm() {\n    this.repform = this.formBuilder.group({\n      contenue: ['', Validators.required]\n    });\n  }\n  initFormmodif(response) {\n    return this.formBuilder.group({\n      contenue: [response?.contenue, Validators.required]\n    });\n  }\n  // Initialize the visibility state for each comment\n  initializeVisibilityState(reponses) {\n    // Get an array of response IDs\n    const responseIds = Object.keys(reponses);\n    // Initialize the visibility state for each response\n    this.showParagraphs = responseIds.map(() => false);\n    console.log(this.showParagraphs);\n  }\n  // Function to toggle the visibility state of a comment's form\n  toggleContent2(commentIndex) {\n    this.showParagraphs[commentIndex] = !this.showParagraphs[commentIndex];\n  }\n  toggleContent() {\n    this.showParagraph = !this.showParagraph;\n  }\n};\nForumComponent = __decorate([Component({\n  selector: 'app-forum',\n  templateUrl: './forum.component.html',\n  styleUrls: ['./forum.component.css']\n})], ForumComponent);\nexport { ForumComponent };","map":{"version":3,"mappings":"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","names":["Component","Validators","Technologie","ForumComponent","constructor","ps","formBuilder","route","ngOnInit","currentUser","initForm","getallQuestion","initFormquest","formGroup","group","contenue","required","addquestion","ajoutQuestion","questform","value","subscribe","res","console","log","tech","valueChanges","data","getQuestions","listofQuestion","isReady","question","reponses","reponse","initFormmodif","formGroups","push","map","initializeVisibilityState","index","indexOf","getnbrvote","id","nbrlike","ajouterreponse","post","repform","addreponse","getcmtbypos","getreponsebyquestion","addlike","vote","delete","cmt","deletereponse","modifierre","rep","updateReponse","response","responseIds","Object","keys","showParagraphs","toggleContent2","commentIndex","toggleContent","showParagraph","selector","templateUrl","styleUrls"],"sourceRoot":"","sources":["C:\\Users\\lahbi\\OneDrive - ESPRIT\\Bureau\\wetransfer_courzello-backoffice_2024-02-21_2018\\Courzello-backOffice\\frontOfficePiDev\\src\\app\\pages\\forum\\forum.component.ts"],"sourcesContent":["import { Component } from '@angular/core';\nimport { FormBuilder, FormGroup, FormsModule, ReactiveFormsModule, Validators } from '@angular/forms';\nimport { Reponse } from '../../model/reponse';\nimport { Question } from '../../model/question';\nimport { QuestionServiceService } from '../../service/question-service.service';\nimport { Router, RouterOutlet } from '@angular/router';\nimport { Vote } from '../../model/vote';\nimport { HttpClientModule } from '@angular/common/http';\nimport { BrowserModule } from '@angular/platform-browser';\nimport { CommonModule } from '@angular/common';\nimport { MatIconModule } from '@angular/material/icon';\nimport { Technologie } from '../../model/technologie';\n\n\n@Component({\n  selector: 'app-forum',\n  templateUrl: './forum.component.html',\n  styleUrls: ['./forum.component.css']\n})\nexport class ForumComponent {\n  currentUser!: String;\n  isReady: boolean = false;\n  questform!: FormGroup;\n  formGroup!: FormGroup;\n  showParagraph: boolean = true;\n  hide: boolean = true;\n  repform!: FormGroup;\n  listofrep: Reponse[] = [];\n  repo: Reponse[] = [];\n  listofQuestion: Question[] = [];\n  tech = Technologie\n  nbrlike: Number[] = []\n  constructor(private ps: QuestionServiceService, private formBuilder: FormBuilder, private route: Router) { }\n\n  ngOnInit(): void {\n    this.currentUser = \"65d621813ece05768b528f25\";\n    this.initForm();\n    this.getallQuestion();\n    this.initFormquest();\n    this.formGroup = this.formBuilder.group({\n      contenue: ['', Validators.required]\n    });\n  }\n  addquestion() {\n    this.ps.ajoutQuestion(this.questform.value, this.currentUser).subscribe(\n      res => {\n        console.log(res)\n        this.getallQuestion()\n      }\n    )\n  }\n  initFormquest() {\n    this.questform = this.formBuilder.group({\n      contenue: ['', Validators.required],\n      tech: [[], Validators.required],\n\n    });\n\n    this.questform.valueChanges.subscribe(\n      data => { console.log(this.questform.value) }\n    )\n  }\n\n  formGroups: FormGroup[] = [];\n  getallQuestion() {\n    this.ps.getQuestions().subscribe(data => {\n      console.log(data);\n      this.listofQuestion = data;\n      this.isReady = true;\n  \n      for (let question of data) {\n        if (question.reponses != null) {\n          for (let reponse of question.reponses) {\n            if (reponse != null) {\n              console.log(reponse);\n              const formGroup = this.initFormmodif(reponse);\n              this.formGroups.push(formGroup);\n              this.formGroups = question.reponses.map(reponse => this.initFormmodif(reponse));\n              this.initializeVisibilityState(reponse);\n            }\n          }\n        }\n  \n        let index = this.listofQuestion.indexOf(question);\n        this.ps.getnbrvote(question.id).subscribe(res => {\n          this.nbrlike[index] = res;\n        });\n      }\n    });\n  }\n  ajouterreponse(post: String) {\n    console.log(this.repform.value);\n    this.ps.addreponse(post, this.currentUser, this.repform.value).subscribe(\n      data => {\n        this.getallQuestion();\n      }\n\n    );\n\n  }\n  getcmtbypos(post: any) {\n    this.ps.getreponsebyquestion(post).subscribe(\n      data => {\n\n      }\n    )\n  }\n\n  \n  addlike(post: Question) {\n    this.ps.vote(post.id, this.currentUser, post).subscribe(\n      data => {\n        console.log(data)\n        this.ps.getnbrvote(post.id).subscribe(\n          res => {\n            console.log(this.nbrlike)\n            let index = this.listofQuestion.indexOf(post);\n            console.log(index)\n            this.nbrlike[index] = res;\n          }\n        )\n      }\n    )\n  }\n  // onTechnologySelected(technology: Technologie) {\n  //   // Handle the selected technology here\n  //   this.questform.patchValue({\n  //     tech: technology\n  //   });\n  // }\n  // onTechnologySelected(select: HTMLSelectElement) {\n  //   const selectedOptions = Array.from(select.selectedOptions).map(option => option.value);\n  //   this.questform.get('tech')?.setValue(selectedOptions);\n  // }\n  delete(cmt: Reponse) {\n    this.ps.deletereponse(cmt.id).subscribe(\n      res => {\n        this.getallQuestion();\n      }\n    )\n  }\n\n  modifierre(rep: Reponse) {\n    this.ps.updateReponse(rep.id, this.formGroup.value).subscribe(\n      data => {\n        this.getallQuestion();\n      }\n    )\n  }\n  initForm() {\n    this.repform = this.formBuilder.group({\n      contenue: ['', Validators.required]\n    });\n  }\n\n  initFormmodif(response: Reponse): FormGroup {\n    return this.formBuilder.group({\n      contenue: [response?.contenue, Validators.required]\n    });\n  }\n  \n  questionsWithResponses: any[] = [];\n  showResponse: boolean[][] = []; \n  showParagraphs: boolean[] = []; // Array to store the visibility state for each comment\n\n  // Initialize the visibility state for each comment\n  initializeVisibilityState(reponses: any) {\n    // Get an array of response IDs\n    const responseIds = Object.keys(reponses);\n    // Initialize the visibility state for each response\n    this.showParagraphs = responseIds.map(() => false);\n    console.log(this.showParagraphs)\n  }\n  \n  \n  // Function to toggle the visibility state of a comment's form\n  toggleContent2(commentIndex: number) {\n    this.showParagraphs[commentIndex] = !this.showParagraphs[commentIndex];\n  }\n  toggleContent() {\n    this.showParagraph = !this.showParagraph;\n}\n}\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}